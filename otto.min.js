!function(){"use strict";var e=function(e,t,l){var o,n,i,a,s,c={config:null,allChoices:null,filteredChoices:[],maxResults:null,minChars:null,source:null,inputValue:"",selected:null,cache:{},redrawTimer:null,root:null,dropdown:null,ul:null,setRedrawTimer:null,applyFilter:null,clearSelected:null,updateList:null};if(c.config=t||{},c.allChoices=l||[],c.config!==Object(c.config))throw"Otto Error: config must be an object.";if(!Array.isArray(c.allChoices))throw"Otto Error: choices must be an array of objects.";return c.allChoices.forEach(function(e){if(e!==Object(e)||!e.label)throw"Otto Error; All choices must be objects with a `label` attribute."}),c.minChars=c.config.minChars||3,c.maxResults=c.config.maxResults||7,c.source=c.config.source||null,c.root=function(e){var t=e;t.autocomplete="off",t.addEventListener("keydown",function(e){38==e.keyCode||40==e.keyCode?(e.preventDefault(),function(e){var t=c.ul.getElementsByClassName("otto-li"),l=t.length,o=null;if(l>0){for(var n=0;n<l;n++)t[n].className.indexOf("otto-selected")>-1&&(o=n);40==e.keyCode?null!==o&&o<l-1?(t[o].className=t[o].className.replace(" otto-selected",""),t[o+1].className+=" otto-selected",c.selected=t[o+1].choice):null===o&&(t[0].className+=" otto-selected",c.selected=t[0].choice):38==e.keyCode&&null!==o&&o>0&&(t[o].className=t[o].className.replace(" otto-selected",""),t[o-1].className+=" otto-selected",c.selected=t[o-1].choice)}}(e)):13==e.keyCode&&e.preventDefault()}),t.addEventListener("keyup",function(e){var l;13==e.keyCode&&(e.preventDefault(),l=e,c.selected&&(c.inputValue=t.value=c.selected.value,c.filteredChoices=[],c.config.valueEvent&&c.config.valueEvent(c.inputValue),c.config.selectEvent&&c.config.selectEvent(c.selected)),c.config.enterEvent&&"none"===c.dropdown.style.display&&c.config.enterEvent(l),c.dropdown.style.display="none")}),t.addEventListener("input",function(e){!function(e){if(c.inputValue=e.target.value,c.selected=null,c.config.valueEvent&&c.config.valueEvent(c.inputValue),c.inputValue.length>=c.minChars){var t=c.inputValue.toUpperCase();c.config.source?c.cache[t]?(c.allChoices=c.cache[t],c.applyFilter(),c.updateList()):c.source(c.inputValue,function(e){c.allChoices=e||[],c.cache[t]=c.allChoices,c.inputValue.length>0&&(c.applyFilter(),c.updateList())}):(c.applyFilter(),c.updateList())}else c.filteredChoices=[],c.updateList()}(e)}),t.addEventListener("focus",function(e){c.setRedrawTimer(),c.filteredChoices.length>0&&(c.dropdown.style.display="")}),t.addEventListener("blur",function(e){c.dropdown.style.display="none"}),c.config.events&&Object.keys(c.config.events).forEach(function(e){t.addEventListener(e,c.config.events[e])});return t}(e),c.dropdown=(o=c.root,n=c.config.divClass||"",(i=document.createElement("div")).className="otto-div "+n,i.style.width=o.offsetWidth.toString()+"px",i.style.top=(o.offsetHeight+o.offsetTop+2).toString()+"px",i.style.left=o.offsetLeft.toString()+"px",i.style.backgroundColor="white",i.style.position="absolute",i.style.overflow="hidden",i.style.zIndex="9999",i.style.display="none",i),c.ul=(a=c.config.ulClass||"",(s=document.createElement("ul")).className="otto-ul "+a,s),c.dropdown.appendChild(c.ul),c.root.insertAdjacentElement("afterend",c.dropdown),c.setRedrawTimer=function(){c.redrawTimer&&clearTimeout(c.redrawTimer),c.redrawTimer=setTimeout(function(){c.dropdown.style.width=c.root.offsetWidth.toString()+"px",c.dropdown.style.top=(c.root.offsetHeight+c.root.offsetTop+2).toString()+"px",c.dropdown.style.left=c.root.offsetLeft.toString()+"px"},500)},c.applyFilter=function(){var e=c.inputValue.toUpperCase(),t=e.length,l=c.allChoices.filter(function(t){var l=t.label;t.matchOn&&(l=t.matchOn);var o=l.toUpperCase().indexOf(e),n=!c.config.matchFullWord||(void 0===l[o-1]||" "===l[o-1]);return o>-1&&n});c.filteredChoices=l.map(function(l){var o={},n=l.label.replace(/&/g,"").replace(/</g,"").replace(/>/g,""),i=n.toUpperCase().indexOf(e);for(var a in o.label=l.label,o.value=l.value||l.label,o.emLabel=i<0?n:n.slice(0,i)+"<b>"+n.slice(i,i+t)+"</b>"+n.slice(i+t),l)o.hasOwnProperty(a)||(o[a]=l[a]);return o})},c.clearSelected=function(){var e=c.ul.getElementsByClassName("otto-li otto-selected");e.length>0&&(e[0].className=e[0].className.replace(" otto-selected",""))},c.updateList=function(){c.ul.innerHTML="",c.filteredChoices.forEach(function(e){var t=function(e,t){var l=document.createElement("li");l.className="otto-li "+t,l.style.listStyleType="none",l.choice=e,l.style.cursor="default",c.config.renderItem?l.innerHTML=c.config.renderItem(e):l.innerHTML=e.emLabel;return l.addEventListener("mouseenter",function(e){c.clearSelected(),e.target.className+=" otto-selected",c.selected=e.target.choice}),l.addEventListener("mouseleave",function(e){e.target.className=e.target.className.replace(" otto-selected",""),c.selected=null}),l.addEventListener("mousedown",function(e){c.inputValue=c.root.value=c.selected.value,c.filteredChoices=[],c.config.valueEvent&&c.config.valueEvent(c.inputValue),c.config.selectEvent&&c.config.selectEvent(c.selected)}),l}(e,c.config.liClass||"");c.ul.appendChild(t)}),c.filteredChoices.length<1?c.dropdown.style.display="none":c.root===document.activeElement&&(c.dropdown.style.display="")},window.addEventListener("resize",function(){c.setRedrawTimer()}),c.updateList(),{Otto:c}};"undefined"!=typeof module&&"object"==typeof exports?module.exports=e:(this||("undefined"!=typeof window?window:global)).Otto=e}();