!function(){"use strict";var e=function(){var e=3,t=7;return function(i,s,n){if(this.config=s||{},this.allChoices=n||[],this.config!==Object(this.config))throw"Otto Error: config must be an object!";if(!Array.isArray(this.allChoices))throw"Otto Error: choices must be an array!";var l,o,a,h,r;this.inputValue="",this.selected=null,this.filteredChoices=[],this.cache={},this.redrawTimer=null,this.root=function(t){var i=t;i.autocomplete="off";var s=function(t){var i=this.config.minChars||e,s=this.config.source||null;if(this.inputValue=t.target.value,this.selected=null,this.config.valueEvent&&this.config.valueEvent(this.inputValue),this.inputValue.length>=i){var n=this.inputValue.toUpperCase();null!==s?this.cache[n]?(this.allChoices=this.cache[n],this.applyFilter(),this.updateList()):s(this.inputValue,function(e){this.allChoices=e||[],this.cache[n]=this.allChoices,this.inputValue.length>0&&(this.applyFilter(),this.updateList())}.bind(this)):(this.applyFilter(),this.updateList())}else this.filteredChoices=[],this.updateList()}.bind(this),n=function(e){null!==this.selected&&(this.inputValue=i.value=this.selected,this.filteredChoices=[],this.config.valueEvent&&this.config.valueEvent(this.inputValue)),this.config.enterEvent&&1==this.dropDown.hidden&&this.config.enterEvent(e),this.dropDown.hidden=!0}.bind(this),l=function(e){var t=document.getElementsByClassName("otto-li"),i=t.length,s=null;if(i>0){for(var n=0;n<i;n++)t[n].className.indexOf("otto-selected")>-1&&(s=n);40==e.keyCode?null!==s&&s<i-1?(t[s].className=t[s].className.replace(" otto-selected",""),t[s+1].className+=" otto-selected",this.selected=t[s+1].dataValue):null===s&&(t[0].className+=" otto-selected",this.selected=t[0].dataValue):38==e.keyCode&&null!==s&&s>0&&(t[s].className=t[s].className.replace(" otto-selected",""),t[s-1].className+=" otto-selected",this.selected=t[s-1].dataValue)}}.bind(this);return i.addEventListener("keydown",function(e){38!=e.keyCode&&40!=e.keyCode||(e.preventDefault(),l(e)),13==e.keyCode&&e.preventDefault()}.bind(this)),i.addEventListener("keyup",function(e){13==e.keyCode&&(e.preventDefault(),n(e))}.bind(this)),i.addEventListener("input",function(e){s(e)}.bind(this)),i.addEventListener("focus",function(){this.filteredChoices.length>0&&(this.dropDown.hidden=!1)}.bind(this)),i.addEventListener("blur",function(){setTimeout(function(){this.dropDown.hidden=!0}.bind(this),100)}.bind(this)),this.config.events&&Object.keys(this.config.events).forEach(function(e){i.addEventListener(e,this.config.events[e])}.bind(this)),i}.call(this,i),this.dropDown=(l=this.root,o=s.divClass||"",(a=document.createElement("div")).className="otto-div "+o,a.style.width=l.offsetWidth.toString()+"px",a.style.top=(l.offsetHeight+l.offsetTop+2).toString()+"px",a.style.backgroundColor="white",a.style.position="absolute",a.style.overflow="hidden",a.style.zIndex="9999",a.hidden=!0,a),this.ulElement=(h=s.ulClass||"",(r=document.createElement("ul")).className="otto-ul "+h,r),this.dropDown.appendChild(this.ulElement),this.root.insertAdjacentElement("afterend",this.dropDown),this.setRedrawTimer=function(){this.redrawTimer&&clearTimeout(this.redrawTimer),this.redrawTimer=setTimeout(function(){this.dropDown.style.width=this.root.offsetWidth.toString()+"px",this.dropDown.style.top=(this.root.offsetHeight+this.root.offsetTop+2).toString()+"px"}.bind(this),500)},window.addEventListener("resize",function(){this.setRedrawTimer()}.bind(this)),this.removeHTML=function(e){return e.replace(/&/g,"").replace(/</g,"").replace(/>/g,"")},this.applyFilter=function(){var e=this.config.maxResults||t,i=this.inputValue.toUpperCase(),s=this.inputValue.length;this.filteredChoices=[];for(var n=[],l=[],o=0;o<this.allChoices.length;o++){var a=this.allChoices[o],h=null,r=null;if(a===Object(a)){if(!a.label)throw"Otto Error: Invalid choice object! Must specify at least `label` attribute.";h=r=a.label,a.matchOn&&(h=a.matchOn)}else r=h=a;r=this.removeHTML(r);var d=h.toUpperCase().indexOf(i),c=r.toUpperCase().indexOf(i),u=!this.config.matchFullWord||void 0===h[d-1]||" "==h[d-1];d>-1&&u&&(n.push({index:c,len:s}),l.push(a))}for(o=0;o<Math.min(e,l.length);o++){var f=null;if(l[o]===Object(l[o])){if(!l[o].label)throw"Otto Error: Invalid choice object!";if(n[o].index<0){this.filteredChoices.push({value:l[o].value||l[o].label,label:l[o].label});continue}f=l[o].label}else f=l[o];f=this.removeHTML(f),this.filteredChoices.push({value:l[o].value||f,label:f.slice(0,n[o].index)+"<b>"+f.slice(n[o].index,n[o].index+n[o].len)+"</b>"+f.slice(n[o].index+n[o].len)})}},this.clearSelected=function(){var e=document.getElementsByClassName("otto-li otto-selected");e.length>0&&(e[0].className=e[0].className.replace(" otto-selected",""))},this.updateList=function(){this.ulElement.innerHTML="",this.filteredChoices.forEach(function(e){var t=function(e,t){var i=document.createElement("li");return i.className="otto-li "+t,i.style.listStyleType="none",i.dataValue=e.value,i.style.cursor="default",this.config.renderItem?i.innerHTML=this.config.renderItem(e.label,e.value):i.innerHTML=e.label,i.addEventListener("mouseenter",function(e){this.clearSelected(),e.target.className+=" otto-selected",this.selected=e.target.dataValue}.bind(this)),i.addEventListener("mouseleave",function(e){e.target.className=e.target.className.replace(" otto-selected",""),this.selected=null}.bind(this)),i.addEventListener("click",function(){this.inputValue=this.root.value=this.selected,this.filteredChoices=[],this.config.valueEvent&&this.config.valueEvent(this.inputValue)}.bind(this)),i}.call(this,e,s.liClass||"");this.ulElement.appendChild(t)}.bind(this)),this.filteredChoices.length<1?this.dropDown.hidden=!0:this.dropDown.hidden=!1},this.updateList()}}();"undefined"!=typeof module&&"object"==typeof exports?module.exports=e:(this||("undefined"!=typeof window?window:global)).Otto=e}();