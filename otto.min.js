!function(){"use strict";var t=function(){var t=3,e=7;return function(i,s,n){var l,o,h,d,a;this.config=s,this.inputValue="",this.selected=null,this.allChoices=n||[],this.filteredChoices=[],this.cache={},this.redrawTimer=null,this.root=function(e){var i=e;i.autocomplete="off";var s=function(e){var i=this.config.minChars||t,s=this.config.source||null;this.inputValue=e.target.value,this.selected=null,this.config.valueEvent&&this.config.valueEvent(this.inputValue),this.inputValue.length>=i?null!==s?this.cache[this.inputValue]?(this.allChoices=this.cache[this.inputValue],this.applyFilter(),this.updateList()):s(this.inputValue,function(t){this.allChoices=t||[],this.cache[this.inputValue]=this.allChoices,this.inputValue.length>0&&(this.applyFilter(),this.updateList())}.bind(this)):(this.applyFilter(),this.updateList()):(this.filteredChoices=[],this.updateList())}.bind(this),n=function(t){null!==this.selected&&(this.inputValue=i.value=this.selected,this.filteredChoices=[],this.config.valueEvent&&this.config.valueEvent(this.inputValue)),this.config.enterEvent&&1==this.dropDown.hidden&&this.config.enterEvent(t),this.dropDown.hidden=!0}.bind(this),l=function(t){var e=document.getElementsByClassName("otto-li"),i=e.length,s=null;if(i>0){for(var n=0;n<i;n++)e[n].className.indexOf("otto-selected")>-1&&(s=n);40==t.keyCode?null!==s&&s<i-1?(e[s].className=e[s].className.replace(" otto-selected",""),e[s+1].className+=" otto-selected",this.selected=e[s+1].innerText):null===s&&(e[0].className+=" otto-selected",this.selected=e[0].innerText):38==t.keyCode&&null!==s&&s>0&&(e[s].className=e[s].className.replace(" otto-selected",""),e[s-1].className+=" otto-selected",this.selected=e[s-1].innerText)}}.bind(this);return i.addEventListener("keydown",function(t){38==t.keyCode||40==t.keyCode?(t.preventDefault(),l(t)):13==t.keyCode&&(t.preventDefault(),n(t))}.bind(this)),i.addEventListener("input",function(t){s(t)}.bind(this)),i.addEventListener("focus",function(){this.filteredChoices.length>0&&(this.dropDown.hidden=!1)}.bind(this)),i.addEventListener("blur",function(){setTimeout(function(){this.dropDown.hidden=!0}.bind(this),100)}.bind(this)),this.config.events&&Object.keys(this.config.events).forEach(function(t){i.addEventListener(t,this.config.events[t])}.bind(this)),i}.call(this,i),this.dropDown=(l=this.root,o=s.divClass||"",(h=document.createElement("div")).className="otto-div "+o,h.style.width=l.offsetWidth.toString()+"px",h.style.top=(l.offsetHeight+l.offsetTop+2).toString()+"px",h.style.backgroundColor="white",h.style.position="absolute",h.style.overflow="hidden",h.style.zIndex="9999",h.hidden=!0,h),this.ulElement=(d=s.ulClass||"",(a=document.createElement("ul")).className="otto-ul "+d,a),this.dropDown.appendChild(this.ulElement),this.root.insertAdjacentElement("afterend",this.dropDown),this.setRedrawTimer=function(){this.redrawTimer&&clearTimeout(this.redrawTimer),this.redrawTimer=setTimeout(function(){this.dropDown.style.width=this.root.offsetWidth.toString()+"px",this.dropDown.style.top=(this.root.offsetHeight+this.root.offsetTop+2).toString()+"px"}.bind(this),500)},window.addEventListener("resize",function(){this.setRedrawTimer()}.bind(this)),this.applyFilter=function(){var t=[],i=this.config.maxResults||e;this.filteredChoices=[];for(var s=this.allChoices.filter(function(e){var i=e.toUpperCase().indexOf(this.inputValue.toUpperCase()),s=!this.config.matchFullWord||void 0===e[i-1]||" "==e[i-1];if(i>-1&&s)return t.push({index:i,len:this.inputValue.length}),!0}.bind(this)),n=0;n<Math.min(i,s.length);n++)this.filteredChoices.push(s[n].slice(0,t[n].index)+"<b>"+s[n].slice(t[n].index,t[n].index+t[n].len)+"</b>"+s[n].slice(t[n].index+t[n].len))},this.clearSelected=function(){var t=document.getElementsByClassName("otto-li otto-selected");t.length>0&&(t[0].className=t[0].className.replace(" otto-selected",""))},this.updateList=function(){this.ulElement.innerHTML="",this.filteredChoices.forEach(function(t){var e=function(t,e){var i=document.createElement("li");return i.className="otto-li "+e,i.style.listStyleType="none",i.innerHTML=t,i.style.cursor="default",i.addEventListener("mouseenter",function(t){this.clearSelected(),t.target.className+=" otto-selected",this.selected=t.target.innerText}.bind(this)),i.addEventListener("mouseleave",function(t){t.target.className=t.target.className.replace(" otto-selected",""),this.selected=null}.bind(this)),i.addEventListener("click",function(){this.inputValue=this.root.value=this.selected,this.filteredChoices=[],this.config.valueEvent&&this.config.valueEvent(this.inputValue)}.bind(this)),i}.call(this,t,s.liClass||"");this.ulElement.appendChild(e)}.bind(this)),this.filteredChoices.length<1?this.dropDown.hidden=!0:this.dropDown.hidden=!1},this.updateList()}}();"undefined"!=typeof module&&"object"==typeof exports?module.exports=t:(this||("undefined"!=typeof window?window:global)).Otto=t}();